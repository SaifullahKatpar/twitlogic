<html>
<head>
    <!-- Customize this SPARQL query for different applications
        TODO: more instructions for constructing widget-friendly SPARQL queries here -->
    <script type='text/sparql' id='sparqlQuery'>
PREFIX dc: <http://purl.org/dc/terms/>
PREFIX foaf: <http://xmlns.com/foaf/0.1/>
PREFIX geo: <http://www.w3.org/2003/01/geo/wgs84_pos#>
PREFIX sioc: <http://rdfs.org/sioc/ns#>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
# Add more namespace definitions as needed

SELECT DISTINCT ?tweet ?createdAt ?text ?screenName ?profileImage ?place ?placeName WHERE {
### begin application-specific patterns ###

#### end application-specific patterns ####
    ?tweet dc:created ?createdAt .
    ?tweet sioc:content ?text .
    ?tweet sioc:has_creator ?account .
    ?account sioc:id ?screenName .
    ?account sioc:account_of ?agent .
    OPTIONAL { ?agent foaf:depiction ?profileImage . } .
    OPTIONAL { ?tweet geo:location ?place .
               ?place dc:title ?placeName . } .
    FILTER(?createdAt > "[LASTTIME]"^^xsd:dateTime) .
} ORDER BY DESC(?createdAt)
LIMIT [LIMIT]
    </script>

    <script type="text/javascript" src="lib/jquery/1.4.2/jquery.min.js"></script>
    <script type="text/javascript" src="lib/timeago/0.8.2/jquery.timeago.js"></script>
    <script type="text/javascript" src="v1/sparql-widget.js"></script>
    <script type="text/javascript">

        $(document).ready(function() {
            /*
            var re = new RegExp("[a-z]+");
            var m = re.exec("foo bar foo");
            if (m == null) {
                alert("No match");
            } else {
                var s = "Match at position " + m.index + ":\n";
                for (var i = 0; i < m.length; i++) {
                    s = s + m[i] + "\n";
                }
                alert(s);
            } */

            var w = new TwitLogic.SparqlWidget({
                version: "...",
                title: "All tweets",
                comment: "Query for all recent tweets",
                query: {
                    sparqlEndpoint: "../../sparql",
//                    sparqlEndpoint: "http://rambo:10042/catalogs/demos/repositories/places-demo",
                    sparqlQuery: document.getElementById("sparqlQuery").innerHTML.trim(),
                    connectionTimeout: 10000,  // Note: should be less than updateInterval
                    updateInterval: 15000
                },
                appearance: {
                    scroll: true,
                    width: "...",
                    height: "...",
                    backgroundColor: "...",
                    alternateColor1: "#F0F0FF",
                    alternateColor2: "#FFFFF8",
                    headerAndFooterTextColor: "...",
                    bodyTextColor: "...",
                    headerBackgroundImage: "...",
                    footerBackgroundImage: "...",
                    maxVisibleTweets: 15
                }
            });

            document.getElementById("widget-goes-here").appendChild(w.widget());
            w.start();
        });
    </script>
    <link media="screen" type="text/css" href="v1/sparql-widget.css" rel="stylesheet"/>
</head>
<body>
<div id="widget-goes-here"></div>
</body>
</html>